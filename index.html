<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Neuro-Fuzzy Asset Evaluator (Vanilla JS)</title>
  <link rel="preconnect" href="https://cdn.jsdelivr.net">
  <link rel="stylesheet" href="style.css">
  
</head>
<body>
  <div class="container">
    <div class="header">
      <div class="title">
        <h1>Neuro-Fuzzy Asset Evaluator</h1>
      </div>
    </div>

    <div class="grid">
      <!-- Input panel -->
      <div class="card">
        <h2 style="margin-top:0">Asset Parameters</h2>

        <div style="display:grid;gap:14px;margin-top:12px">

          <div>
            <label>Current Asset Value (₹)</label>
            <div class="hint">Present market value used as baseline for predictions. For stocks, use market cap; for real estate, market price.</div>
            <input id="currentValue" type="number" placeholder="e.g., 8300000" />
          </div>

          <div>
            <label>Historical Growth Rate (% per year)</label>
            <div class="hint">Average annual % change over past 3–5 years.</div>
            <input id="historicalGrowth" type="number" placeholder="e.g., 8.5" />
          </div>

          <div>
            <label>Market Volatility Index (0–100)</label>
            <div class="hint">0–20 stable; 20–50 moderate; 50–100 high volatility.</div>
            <input id="marketVolatility" type="number" placeholder="e.g., 25" />
          </div>

          <div>
            <label>Economic Indicator Score (-10 to +10)</label>
            <div class="hint">Macro health: GDP, inflation, employment, consumer confidence.</div>
            <input id="economicIndicator" type="number" placeholder="e.g., 5" />
          </div>

          <div>
            <label>Industry Trend Score (-5 to +5)</label>
            <div class="hint">Sector outlook: disruption, demand, regulation.</div>
            <input id="industryTrend" type="number" placeholder="e.g., 3" />
          </div>

          <div>
            <label>Time Horizon (years)</label>
            <div class="hint">How many years ahead to project (compound growth).</div>
            <select id="timeHorizon">
              <option value="1">1 Year</option>
              <option value="3">3 Years</option>
              <option value="5">5 Years</option>
              <option value="10">10 Years</option>
            </select>
          </div>

          <button id="evaluateBtn" class="primary" disabled>Evaluate Asset</button>
        </div>
      </div>

      <!-- Results panel -->
      <div class="card">
        <h2 style="margin-top:0">Prediction Results</h2>

        <div id="resultsArea">
          <div class="placeholder">
            <div style="text-align:center">
              <div style="margin-top:12px;color:rgba(190,180,255,0.6)">Enter asset parameters and click "Evaluate Asset"</div>
            </div>
          </div>
        </div>

      </div>
    </div>

  </div>
<script src="script.js"></script>
<script>
// -- Utility: DOM helpers
const by = id => document.getElementById(id);

// -- Fuzzy membership functions (ported from React)
function fuzzyLow(x, min, max){
  if(x <= min) return 1;
  if(x >= max) return 0;
  const ratio = (max - x) / (max - min);
  return Math.pow(ratio, 0.7);
}
function fuzzyMedium(x, min, mid, max){
  if(x <= min || x >= max) return 0;
  if(x === mid) return 1;
  if(x < mid){
    const ratio = (x - min) / (mid - min);
    return Math.pow(ratio, 0.8);
  }
  const ratio = (max - x) / (max - mid);
  return Math.pow(ratio, 0.8);
}
function fuzzyHigh(x, min, max){
  if(x <= min) return 0;
  if(x >= max) return 1;
  const ratio = (x - min) / (max - min);
  return Math.pow(ratio, 0.7);
}

// -- Normalizers
function normalizeGrowth(growth){
  const g = parseFloat(growth) || 0;
  return Math.max(0, Math.min(1, (g + 50) / 100));
}
function normalizeVolatility(vol){
  const v = parseFloat(vol) || 0;
  return Math.max(0, Math.min(1, v / 100));
}
function normalizeIndicator(ind){
  const i = parseFloat(ind) || 0;
  return Math.max(0, Math.min(1, (i + 10) / 20));
}
function normalizeTrend(trend){
  const t = parseFloat(trend) || 0;
  return Math.max(0, Math.min(1, (t + 5) / 10));
}

// -- Neural process (ported)
function neuralProcess(inputs){
  const weights1 = {
    growth: [0.40, -0.15, 0.25, 0.30],
    volatility: [-0.25, -0.30, 0.10, -0.20],
    economic: [0.30, 0.35, -0.10, 0.25],
    industry: [0.25, 0.20, 0.30, 0.15]
  };
  const weights2 = [0.35, 0.30, 0.20, 0.15];
  const biases1 = [0.1, -0.05, 0.15, 0.08];
  const bias2 = 0.05;

  const hidden1 = [];
  for(let i=0;i<4;i++){
    let sum = biases1[i];
    sum += inputs.growth * weights1.growth[i];
    sum += inputs.volatility * weights1.volatility[i];
    sum += inputs.economic * weights1.economic[i];
    sum += inputs.industry * weights1.industry[i];
    hidden1.push(Math.max(0,sum));
  }

  let output = bias2;
  for(let i=0;i<4;i++) output += hidden1[i] * weights2[i];

  const normalized = Math.tanh(output * 1.2);
  const momentum = inputs.growth * 0.15;
  return Math.tanh(normalized + momentum);
}

// -- Fuzzy inference (ported)
function fuzzyInference(neuralOutput, volatility, growth, economic){
  const growthLow = fuzzyLow(neuralOutput, -0.6, 0.2);
  const growthMed = fuzzyMedium(neuralOutput, -0.2, 0.5, 0.85);
  const growthHigh = fuzzyHigh(neuralOutput, 0.3, 1.0);

  const volLow = fuzzyLow(volatility, 0, 0.35);
  const volMed = fuzzyMedium(volatility, 0.25, 0.5, 0.75);
  const volHigh = fuzzyHigh(volatility, 0.65, 1.0);

  const econPositive = fuzzyHigh(economic, 0.4, 1.0);
  const econNeutral = fuzzyMedium(economic, 0.2, 0.5, 0.8);
  const econNegative = fuzzyLow(economic, 0, 0.6);

  const rules = [
    { condition: Math.min(growthHigh, volLow, econPositive), output: 0.95, confidence: 'Exceptional' },
    { condition: Math.min(growthHigh, volLow, econNeutral), output: 0.90, confidence: 'Very High' },
    { condition: Math.min(growthHigh, volLow, econNegative), output: 0.82, confidence: 'High' },
    { condition: Math.min(growthHigh, volMed, econPositive), output: 0.85, confidence: 'High' },
    { condition: Math.min(growthHigh, volMed, econNeutral), output: 0.78, confidence: 'High' },
    { condition: Math.min(growthHigh, volMed, econNegative), output: 0.68, confidence: 'Moderate-High' },
    { condition: Math.min(growthHigh, volHigh, econPositive), output: 0.70, confidence: 'Moderate-High' },
    { condition: Math.min(growthHigh, volHigh, econNeutral), output: 0.60, confidence: 'Moderate' },
    { condition: Math.min(growthHigh, volHigh, econNegative), output: 0.48, confidence: 'Moderate' },

    { condition: Math.min(growthMed, volLow, econPositive), output: 0.80, confidence: 'High' },
    { condition: Math.min(growthMed, volLow, econNeutral), output: 0.72, confidence: 'Moderate-High' },
    { condition: Math.min(growthMed, volLow, econNegative), output: 0.62, confidence: 'Moderate-High' },
    { condition: Math.min(growthMed, volMed, econPositive), output: 0.68, confidence: 'Moderate-High' },
    { condition: Math.min(growthMed, volMed, econNeutral), output: 0.55, confidence: 'Moderate' },
    { condition: Math.min(growthMed, volMed, econNegative), output: 0.42, confidence: 'Moderate' },
    { condition: Math.min(growthMed, volHigh, econPositive), output: 0.50, confidence: 'Moderate' },
    { condition: Math.min(growthMed, volHigh, econNeutral), output: 0.38, confidence: 'Moderate-Low' },
    { condition: Math.min(growthMed, volHigh, econNegative), output: 0.28, confidence: 'Low' },

    { condition: Math.min(growthLow, volLow, econPositive), output: 0.45, confidence: 'Moderate' },
    { condition: Math.min(growthLow, volLow, econNeutral), output: 0.35, confidence: 'Moderate-Low' },
    { condition: Math.min(growthLow, volLow, econNegative), output: 0.25, confidence: 'Low' },
    { condition: Math.min(growthLow, volMed, econPositive), output: 0.32, confidence: 'Moderate-Low' },
    { condition: Math.min(growthLow, volMed, econNeutral), output: 0.22, confidence: 'Low' },
    { condition: Math.min(growthLow, volMed, econNegative), output: 0.15, confidence: 'Very Low' },
    { condition: Math.min(growthLow, volHigh, econPositive), output: 0.20, confidence: 'Low' },
    { condition: Math.min(growthLow, volHigh, econNeutral), output: 0.12, confidence: 'Very Low' },
    { condition: Math.min(growthLow, volHigh, econNegative), output: 0.05, confidence: 'Critical' }
  ];

  let numerator = 0, denominator = 0, maxConfidence = { level: '', value: 0 }, totalActivation = 0;
  rules.forEach(rule =>{
    const activation = Math.pow(rule.condition, 0.85);
    numerator += activation * rule.output;
    denominator += activation;
    totalActivation += rule.condition;
    if(rule.condition > maxConfidence.value){ maxConfidence = { level: rule.confidence, value: rule.condition } }
  });

  const crispOutput = denominator > 0 ? numerator / denominator : 0.5;
  const certaintyFactor = Math.min(1, totalActivation / 3);
  const adjustedOutput = crispOutput * (0.85 + certaintyFactor * 0.15);

  return { crispOutput: adjustedOutput, confidence: maxConfidence.level, certaintyScore: certaintyFactor };
}

// -- Main calculation
function calculatePrediction(){
  setUIProcessing(true);

  setTimeout(()=>{
    const currentVal = parseFloat(by('currentValue').value) || 0;
    const timeHorizon = parseInt(by('timeHorizon').value,10) || 1;

    const normalizedInputs = {
      growth: normalizeGrowth(by('historicalGrowth').value),
      volatility: normalizeVolatility(by('marketVolatility').value),
      economic: normalizeIndicator(by('economicIndicator').value),
      industry: normalizeTrend(by('industryTrend').value)
    };

    const neuralOutput = neuralProcess(normalizedInputs);

    const { crispOutput, confidence, certaintyScore } = fuzzyInference(
      neuralOutput,
      normalizedInputs.volatility,
      normalizedInputs.growth,
      normalizedInputs.economic
    );

    const baseGrowthFactor = 1 + (crispOutput - 0.5) * 2 * 0.35; // -35% to +35%
    const industryBoost = (normalizedInputs.industry - 0.5) * 0.15;
    const enhancedGrowthFactor = baseGrowthFactor * (1 + industryBoost);

    const annualGrowth = Math.pow(enhancedGrowthFactor, timeHorizon);
    const predictedValue = currentVal * annualGrowth;

    const baseVolatility = normalizedInputs.volatility * 0.18;
    const adjustedVolatility = baseVolatility * (1.2 - certaintyScore * 0.4);
    const lowerBound = predictedValue * (1 - adjustedVolatility);
    const upperBound = predictedValue * (1 + adjustedVolatility);

    const result = {
      predicted: predictedValue,
      lower: lowerBound,
      upper: upperBound,
      confidence: confidence,
      growthRate: currentVal ? ((predictedValue - currentVal) / currentVal) * 100 : 0,
      neuralScore: neuralOutput,
      fuzzyScore: crispOutput,
      certaintyScore: certaintyScore
    };

    renderResult(result);
    setUIProcessing(false);
  }, 900);
}

// -- UI helpers
function fmtINR(x, digits=2){
  try{
    return new Intl.NumberFormat('en-IN', { style:'currency', currency:'INR', minimumFractionDigits:digits, maximumFractionDigits:digits }).format(x);
  }catch(e){return '₹' + Number(x).toFixed(digits)}
}

function renderResult(res){
  const html = `
    <div style="display:grid;gap:12px">
      <div class="result-hero">
        <p style="font-size:12px;margin:0;color:rgba(235,255,235,0.9)">Predicted Future Value</p>
        <p style="font-size:26px;font-weight:700;margin:6px 0">${fmtINR(res.predicted,2)}</p>
        <p style="margin:0;color:rgba(235,255,235,0.9)">${res.growthRate>=0?'+':''}${res.growthRate.toFixed(2)}% total growth</p>
      </div>

      <div class="two">
        <div class="small-card">
          <div class="meta">Lower Bound</div>
          <div style="font-weight:700;font-size:18px;margin-top:6px">${fmtINR(res.lower,0)}</div>
        </div>
        <div class="small-card">
          <div class="meta">Upper Bound</div>
          <div style="font-weight:700;font-size:18px;margin-top:6px">${fmtINR(res.upper,0)}</div>
        </div>
      </div>

      <div class="small-card">
        <div style="display:flex;align-items:center;gap:12px">
          <div style="flex:1">
            <div class="meta">Confidence Level</div>
            <div class="progress" style="margin-top:8px"><div class="bar" style="width:${(res.fuzzyScore*100)}%;background:linear-gradient(90deg,var(--accent1),var(--accent2))"></div></div>
          </div>
          <div style="min-width:110px;text-align:right;font-weight:700">${res.confidence || '—'}</div>
        </div>
      </div>

      <div style="border-top:1px solid rgba(124,58,237,0.12);padding-top:10px">
        <h3 style="margin:0 0 8px 0">AI Analysis Scores</h3>
        <div style="display:grid;gap:8px">
          <div style="display:flex;justify-content:space-between"><span class="meta">Neural Network Output</span><span class="mono">${res.neuralScore.toFixed(3)}</span></div>
          <div style="display:flex;justify-content:space-between"><span class="meta">Fuzzy Logic Score</span><span class="mono">${res.fuzzyScore.toFixed(3)}</span></div>
          <div style="display:flex;justify-content:space-between"><span class="meta">Certainty Factor</span><span class="mono">${(res.certaintyScore*100).toFixed(1)}%</span></div>
        </div>
      </div>

      <div class="note"> <strong>Note:</strong> This prediction combines neural network pattern recognition with fuzzy logic reasoning to handle uncertainty. Use as one factor in investment decisions.</div>
    </div>
  `;
  by('resultsArea').innerHTML = html;
}

function setUIProcessing(isProcessing){
  const btn = by('evaluateBtn');
  btn.disabled = isProcessing || !isFormValid();
  btn.textContent = isProcessing ? 'Processing...' : 'Evaluate Asset';
}

function isFormValid(){
  const vals = [by('currentValue').value, by('historicalGrowth').value, by('marketVolatility').value, by('economicIndicator').value, by('industryTrend').value, by('timeHorizon').value];
  return vals.every(v => String(v).trim() !== '');
}

// -- Wiring
const inputs = ['currentValue','historicalGrowth','marketVolatility','economicIndicator','industryTrend','timeHorizon'];
inputs.forEach(id=>{
  const el = by(id);
  el.addEventListener('input', ()=>{ by('evaluateBtn').disabled = !isFormValid(); });
  el.addEventListener('change', ()=>{ by('evaluateBtn').disabled = !isFormValid(); });
});

by('evaluateBtn').addEventListener('click', ()=>{
  if(!isFormValid()) return;
  calculatePrediction();
});

// initialize
by('evaluateBtn').disabled = true;

</script>
</body>
</html>
